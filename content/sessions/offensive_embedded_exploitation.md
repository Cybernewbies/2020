---
key: offensive_embedded_exploitation
title: Offensive Embedded Exploitation
id: PmoMEVHO3imfUIMXsPai
language: English
format: hands-on
tags:
  - _iot
level: beginner
speakers:
  - kaustubh_padwad
videoId: 
<!--presentation: https://www.blockchainvillage.net/ -->
draft: false
---
<h2>Offensive Embedded Exploitation : Getting hands dirty with IOT/Embedded Device Security Testing.</h2>

Offensive Embedded Exploitation : Getting hands dirty with IOT/Embedded Device Security Testing.

The world is moving towards smart culture everything nowadays is smart, and mostly all are those smart
devices are basically embedded devices with internet connectivity or some provision to connect with the
internet, since this devices are booming, This devices are also tempting lots of people/groups for hacking
or security testing. In this talk/workshop we will discuss how to test the embedded or IOT devices, it would 
give you a methodology for testing, how to conduct firmware analysis, identifying vulnerable components, basic
approach for reverse engineering the binaries to discover potential remote code execution, memory corruption 
vulnerabilities by looking for native vulnerable functions in C or bad implementation of functions
like System, popen, pclose etc.After conducting static analysis using document review and firmware analysis 
we will move towards dynamic testing which include web application testing, Underlying Linux os security 
testing identifying vulnerabilities and misconfiguration in device. and then will move towards fuzzing the 
device via web application parameters and installing debugger on mips device to identify memory corruption
vulnerabilities. and to summarize this will end our talk with reporting vulnerabilities.


<h2>Preparing the Arsenal:</h2>
<ul>   
<li>Setting up testing machine for embedded system testing with required tools</li>
<li>Identifying the physical entry point of the devices Eg. Jtag,Uart,SPI,USB,Console,Minicom.</li>
<li>Identifying the logical entry points like network(WiFi,ethernet),Zigbee,Zwave,Bluetooth or other RF.</li>
<li>Installing and configuring the QEMU for emulating the binary.</li>
<li>Debootstrap basics for making virtual arm testing machine on the Debian.</li>
</ul>

<h2>Reconnaissance (Live-Demo):</h2>
<ul>
<li>Understanding the device chipset,FCCID,Supported protocols, Communication by device.Getting every possible details from the documents provided,avaiable.</li>
<li>Active device scanning to figure out OS,Arch,Services,ports running on device. Identifying the Attack surface on device.</li>
<li>Some basic concepts Microcontroller, Modem, Basically will walk though the device.</li>
</ul>

<h2>Firmware Analysis(Live Demo):</h2>

In this section we will find out multiple ways to get that .bin file by some osint or intercepting the upgrade of device 
or from the official vendor website, then will look for types of file system for devices. once we understand the file system 
we will move forward for extracting fimrware  with the help multiple tools like hex editor dd,binwalk,string. 
After successful extraction we will perform binary,library,code analysis to identify the potential vulnerabilities to pwn the shell. below 
will be key highlights of the section
<ul>
<li>various  ways to obtain the firmware.</li>
<li>one firmware which i will provide with the link to dwonload from web or from the local server.</li>
<li>extracting firmware with binwalk and dd, and configuring binwalk to supoort all the firmware. (default one does not work with all file system)</li>
<li>tricks to identify the vulnerabilities in firmware, looking for outdated components,libs,crownjobs,shellcode, iptables, etc.</li>
<li>Reviewing shell scripts. </li>
<li>Emulating The binary on debootstrap and QEMU.  </li>
<li>Online recon using FCCID, some other sources </li>
<li>Mapping the device with identified services and vulnerabilities</li>
<li>Some more passive and active recon techniques.</li>

<h2>Sys internal Testing(Live Demo):</h2>

As mentioned in the previous section going through the process we would explore potential vulnerabilities in the device now further we would exploit the same to gain the shell or persistent access to the device by abusing the permissions or cronjobs or executing the privilege code to maintain the persistent access of device for further testing and to cover most of the vulnerabilities.

<h2>Basic Binary Analysis(Partial Live Demo):</h2>

Now as mentioned above we would have an persistent access to device, moving ahead we can download those code or the binaries to our system for further analysis and by reversing the binaries we would identify the improper implementation of native vulnerable functions like system,popen,pclose,printf and some others to get the real critical vulnerabilities which could get fuzz in next section to develop the exploit.
<ul>
<li>I have two sample firmware which i have tested and identified shell command injection. </li>
<li>One firmware i will demonstrate the how i have identified the shell command injection using ida pro (with screenshot or maybe live with community edition)</li>
<li>Second firmware i will demonstrate how i have identified the unauthenticated buffer overflow usig ida pro, and some simple techniques for RE.</li>
<li>Start the fuzzing by either emulating the binary using qemu or running gdbserver on device and attaching process on gdb  and then sending fuzz request by either burp or socket in python.</li>
<li>Identifying the crash or how to crash and controlling the registers. </li>
<li>If possible i will demonstrate the shell command injection on MIPS by fuzzing but till now i dont have ROP chain so not sure about it.</li>
<li>Identifying some more vulnerabilities using IDA PRo with sample binaries. </li>
</ul>

<h2>Fuzzing(Live-Demo):</h2>

Note:- In this section we will setup FuZZ-RE section. In this if device is capable and crowd is limited then we may make this hand's on section 
<ul>
<li>Obtaining the correct debugger and setting up the debugger for the debugging.</li>
<li>Identifing the correct parameter </li>
<li>Prepring the fuzzer list and observring the behaviour of binary while handling the excetions.</li>
<li>Identifying the registers. and designing the way to exploit.</li>
<li>Exploit development in Python  using structs and socket.</li>
<li>Final exploit for delivering Seg fault.</li>
<li>Basics of ROP chains.<li>

<h2>Closing notes:</h2>
<ul>
<li>Here we summarize all the analysis which we have gone through in the above mention highlights and vulnerabilities make a perfect testing report. </li>
<li>Question and answers </li>
<li>Some extra tips for testing.</li>
</ul>

<h2>What you will get from this session :</h2>

This is a the complete new testing Methodology,  In this talk we will cover how to test and embedded device from beginner level to intermediate or expert level. additionally this talk includes live demo of the testing so this will create more interest in audience  and they might get motivated for testing IOT/ Embedded devices. 

<h2>About Trainer :</h2>

<b>Kaustubh</b> is an Embedded system security researcher and Device security Assurance Manager at  Reliance Jio Infocomm limited, his main work include Securing  JIO's Cutting Edge Enterprise, Consumer, and SMB(small,Medium,Big) business products. His main area of interest is Device security,Reverse engineering, discovering RCE,Priv-esc bugs in proprietary or close source devices. He was Null champion, He had deliver more than dozens of talk in null meet and he was champion for 3 years in null community. Some of his works are published in SecurityWeek, ExploitDB, 0day.today and have more than Dozens of CVE, Recently he was the winner of SCADA CTF @ nullcon 2019.

<a align="center" class="btn primary" target="_blank" rel="noopener" href="https://docs.google.com/forms/d/1nLB0vlp49FRicjwI9R8WRXTfUkgVXJLYTem8LjVfAXw/">Register</a>